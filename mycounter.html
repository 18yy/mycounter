<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>myCounter</title>
  <style>
    h2 {
      text-align: center;
      color: #666;
      margin: 30px 0 30px 0;
    }

    body {
      background: rgb(247, 250, 252);
    }

    .correctAnswer {
      display: none;
      padding-left: 15px;
      color: rgb(230, 80, 80);
    }

    .wrap {
      padding: 30px 10px;
      margin: 20px auto;
      width: 50%;
      height: auto;
      min-height: 300px;
      background: white;
      border: 1px solid rgb(218, 218, 218);
      border-radius: 15px;
    }

    .choiceBox {
      width: 100%;
      display: flex;
      justify-content: space-around;
    }

    .btnBox {
      width: 100%;
      padding: 20px 0;
      display: flex;
      justify-content: space-around;
    }

    label {
      font-size: 13px;
    }

    input {
      width: 30px;
      height: 15px;
    }

    .qusBox {
      width: 80%;
      height: auto;
      min-height: 10px;
      padding: 10px 0 30px 20px;
      margin: 0 auto;
      background: rgb(228, 231, 235);
      text-align: left;
      font-size: 15px;
      line-height: 25px;
    }

    #comment {
      font-size: 12px;
      padding-left: 40px;
      padding-top: 20px;
      color: rgb(176, 70, 70);
    }
  </style>
</head>

<body>
  <h2>小学生的四则运算题</h2>
  <div class="wrap">
    <div class="choiceBox">
      <div>
        <label for="qustionNum">题目个数：</label>
        <input type="text" id="qustionNum">
      </div>
      <div>
        <label for="maxNum">运算不超过的数字:</label>
        <input type="text" id="maxNum">
      </div>
    </div>
    <div class="btnBox">
      <button type="button" onclick="playAll()">开始生成题目</button>
      <button type="button" id="completedBtn">完成答题题目</button>
    </div>
    <div class="qusBox">
      <span id="myQus"></span>
    </div>
    <div id="comment">
    </div>
  </div>
  <script>
    // //随机函数，获得min到max范围内的随机数包括min和max
    // function getRandomNum(min, max) {
    //   var range = max - min;
    //   return (Math.round(Math.random() * range + min));
    // }

    //求最大公约数
    function getGCD(a, b) {
      var temp;
      while (b != 0) {
        temp = a % b;
        a = b;
        b = temp;
      }
      return a;
    }

    //转化成分数的形式
    function getFract(a, b, gcd) {
      if (gcd == 1) {
        if (a > b) {
          //最大公约数为1且分子大于分母，用真分数形式表示
          var n = parseInt(a / b);
          a = a % b;
          return n + "'" + a + "/" + b;
        } else {
          return a + "/" + b;
        }
      } else if (gcd == b) {
        return a / b;
      } else {
        a = a / gcd;
        b = b / gcd;
        return a + "/" + b;
      }
    }

    //把分数转化为真分数或整数
    function TrueFract(molecule, denominator) {
      if (molecule % denominator !== 0) {
        var gcd = getGCD(molecule, denominator);
        var sum = getFract(molecule, denominator, gcd);
      } else {
        var sum = molecule / denominator;
      }
      return sum;
    }

    //整数的随机四则运算
    function countInt(a, b, maxNum, operator) {
      // var arry = ["+", "-", "*", "/"];
      // var n = getRandomNum(0, 3);
      //匹配运算符
      switch (operator) {
        case "+":
          {

            var sum = a + b;
            var info = {
              "question": a + '+' + b + '=',
              "answer": sum
            };
            // return a + "+" + b + "=" + sum;
            return sum;
            break;
          }
        case "-":
          {
            var sum = a - b;
            //如果是负数情况，重新随机生成数直到结果非负
            while (sum < 0) {
              var a = getRandomNum(1, maxNum);
              var b = getRandomNum(1, maxNum);
              var sum = a - b;
            }
            var info = {
              "question": a + '-' + b + '=',
              "answer": sum
            };
            return sum;
            // return a + "-" + b + "=" + sum;
            break;
          }
        case "*":
          {
            var sum = a * b;
            var info = {
              "question": a + 'x' + b + '=',
              "answer": sum
            };
            return sum;
            // return a + "x" + b + "=" + sum;
            break;
          }
        case "/":
          {
            while (b == 0) {
              var b = getRandomNum(1, maxNum);
            }
            //如果分子不能整除分母，运行getFract函数把答案变成分数形式
            var sum = TrueFract(a, b);
            var info = {
              "question": a + '÷' + b + '=',
              "answer": sum
            };
            return sum;
            // return a + "÷" + b + "=" + sum;
            break;
          }

        default:
          break;
      }
    }

    // //分数的随机四则运算
    // function countFract(a, b, c, d, maxNum) {
    //   var arry = ["+", "-", "*", "/"];
    //   var n = getRandomNum(0, 3);
    //   //匹配运算符
    //   switch (arry[n]) {
    //     case "+":
    //       {
    //         var molecule = a * d + b * c;
    //         var denominator = c * d;
    //         var TrueFractA = TrueFract(a, c);
    //         var TrueFractB = TrueFract(b, d);
    //         var sum = TrueFract(molecule, denominator);
    //         return TrueFractA + "+" + TrueFractB + "=" + sum;
    //         break;
    //       }
    //     case "-":
    //       {
    //         var molecule = a * d - b * c;
    //         //如果是负数情况，重新随机生成数直到结果非负
    //         while (molecule < 0) {
    //           var a = getRandomNum(1, maxNum);
    //           var b = getRandomNum(1, maxNum);
    //           var c = getRandomNum(1, maxNum);
    //           var d = getRandomNum(1, maxNum);
    //           var molecule = a * d - b * c;
    //         }
    //         if (molecule == 0) {
    //           var sum = 0;
    //         } else {
    //           var denominator = c * d;
    //           var TrueFractA = TrueFract(a, c);
    //           var TrueFractB = TrueFract(b, d);
    //           var sum = TrueFract(molecule, denominator);
    //         }
    //         return TrueFractA + "-" + TrueFractB + "=" + sum;
    //         break;
    //       }
    //     case "*":
    //       {
    //         var molecule = a * b;
    //         var denominator = c * d;
    //         var TrueFractA = TrueFract(a, c);
    //         var TrueFractB = TrueFract(b, d);
    //         var sum = TrueFract(molecule, denominator);
    //         return TrueFractA + "x" + TrueFractB + "=" + sum;
    //         break;
    //       }
    //     case "/":
    //       {
    //         var molecule = a * d;
    //         var denominator = c * b;
    //         var TrueFractA = TrueFract(a, c);
    //         var TrueFractB = TrueFract(b, d);
    //         var sum = TrueFract(molecule, denominator);
    //         return TrueFractA + "÷" + TrueFractB + "=" + sum;
    //         break;
    //       }

    //     default:
    //       break;
    //   }

    // }


    // //运行countInt函数
    // function playCountInt(maxNum) {
    //   var a = getRandomNum(1, maxNum);
    //   var b = getRandomNum(1, maxNum);
    //   var c = getRandomNum(1, maxNum);
    //   var d = getRandomNum(1, maxNum);
    //   var IsInt = getRandomNum(0, 1);
    //   var operator_num = getRandomNum(1, 3);
    //   // if (IsInt == "1") {
    //   //   var sum = countInt(a, b, maxNum);
    //   // } else {
    //   //   var sum = countFract(a, b, c, d, maxNum);
    //   // }
    //   var sum = countInt(a, b, maxNum);
    //   // console.log(sum["answer"]);
    //   return sum;
    // }


    // function playAll() {

    //   //将页面清空
    //   // document.getElementsByClassName("correctAnswer").setAttribute('display', 'none');
    //   document.getElementById("myQus").innerHTML = "";
    //   document.getElementById("comment").innerHTML = "";
    //   //题目数目
    //   var qustionNum = document.getElementById("qustionNum").value;
    //   //运算范围，最大运算数字
    //   var maxNum = document.getElementById("maxNum").value;
    //   for (i = 1; i <= qustionNum; i++) {

    //     document.getElementById("myQus").innerHTML += ("<br>" + "第" + i + "题：");

    //     var myquanstions = playCountInt(maxNum);


    //     document.getElementById("myQus").innerHTML += myquanstions["question"] +
    //       "<input type='text' class='myAnswer' />" + "<span class='correctAnswer'>" + myquanstions["answer"] +
    //       "</span>";


    //   }

    // }
    // document.getElementById('completedBtn').onclick = function () {

    //   var trueNum = 0;
    //   var falseNum = 0;
    //   var b = document.getElementsByClassName('myAnswer');
    //   var a = document.getElementsByClassName('correctAnswer');
    //   for (i = 0; i < b.length; i++) {
    //     if (b[i].value == a[i].innerHTML) {
    //       trueNum++;
    //     } else {
    //       falseNum++;
    //     }
    //     a[i].style.display = "inline-block";
    //   }
    //   document.getElementById("comment").innerHTML += ":)正确的个数为:" + trueNum + "<br>" + " :(错误的个数为: " +
    //     falseNum;

    //   console.log(trueNum);
    //   console.log(falseNum);
    // }


    /*****************************************************/
    var arry = ["+", "-", "*", "/"];
    var countArry = new Array();

    //随机函数，获得min到max范围内的随机数包括min和max
    function getRandomNum(min, max) {
      var range = max - min;
      return (Math.round(Math.random() * range + min));
    }
    //随机生成问题集合
    function randomQus(qusNum) {
      var countArry = [qusNum];
      var charArry = [];
      for (var k = 0; k < qusNum; k++) {
        countArry[k] = '';
      }
      for (var j = 0; j < qusNum; j++) {
        //var coutArry = null;
        var n = 1; //随机获得运算符的个数
        var numberOfCount = new Array(n + 1);
        var CountStr;
        for (var i = 0; i <= n; i++) {
          numberOfCount[i] = getRandomNum(0, 30); //随机获得数字的函数（需要改）
        }
        for (var i = 0; i < n; i++) {
          var m = getRandomNum(0, 3); //随机选择运算符
          countArry[j] += numberOfCount[i] + arry[m]; //随机数字和随机运算符拼接

        }
        countArry[j] += numberOfCount[n];
        countIt(countArry[j]);
        // countArry.length = 0;
      }

      return countArry;
    }
    //计算式子
    function countIt(params) {
      console.log(eval(params));
      //       var n = 100;
      var num = params.split(/[\+\-\*\/]/);
      var operator = params.match(/[\+\-\*\/]/g);
      var sum = countInt(parseInt(num[0]),parseInt(num[1]),30,operator[0]);
      console.log(sum);
      console.log(num);
      console.log(operator);

    }

    function playAll() {
      // var a=new Array();
      // for(i=0;i<3;i++){
      //   a[i] = randomCount(); 
      // }
      var a = randomQus(6);
      console.log(a);

    }

    // /**********************************************/
  </script>
</body>

</html>