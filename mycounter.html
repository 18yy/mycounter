<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>myCounter</title>
</head>

<body>
  <label for="qustionNum">题目个数：</label>
  <input type="text" id="qustionNum">
  <br/>
  <label for="maxNum">运算不超过的数字:</label>
  <input type="text" id="maxNum">
  <br/>
  <button type="button" onclick="playAll()">开始生成题目</button>
  <span id="text"></span>
  <script>
    //随机函数，获得min到max范围内的随机数包括min和max
    function getRandomNum(min, max) {
      var range = max - min;
      return (Math.round(Math.random() * range + min));
    }

    /*//求最大公约数
    function getGCD(a, b) {
      var temp;
      while (b != 0) {
        temp = a % b;
        a = b;
        b = temp;
      }
      return a;
    }
*/
    //分数转化为真分数或整数
    function TrueFract(molecule,denominator) {
       if(molecule < denominator) {
            var sum = molecule + '/' + denominator;
        }else if(molecule % denominator == 0) {
            var sum = molecule / denominator;
        }else if(molecule > denominator) {
            var FractionInt = parseInt(molecule / denominator);
            var molecule = molecule % denominator;
            var sum = FractionInt + '\'' + molecule + '/' + denominator;
        }
        return sum;
    }
    
    /*//转化成分数的形式
    function getFract(a, b, gcd) {
      if (gcd == 1) {
        if (a > b) {
          //最大公约数为1且分子大于分母，用真分数形式表示
          var n = parseInt(a / b);
          a = a % b;
          return n + "'" + a + "/" + b;
        } else {
          return a + "/" + b;
        }
      } else {
        a = a / gcd;
        b = b / gcd;
        return a + "/" + b;
      }
    }*/

    //整数的随机四则运算
    function countInt(a, b, maxNum) {
      var arry = ["+", "-", "*", "/"];
      var n = getRandomNum(0, 3);
      //匹配运算符
      switch (arry[n]) {
        case "+":
          {
            var sum = a + b;
            return a + "+" + b + "=" + sum;
            break;
          }
        case "-":
          {
            var sum = a - b;
            //如果是负数情况，重新随机生成数直到结果非负
            while (sum < 0) {
              var a = getRandomNum(1, maxNum);
              var b = getRandomNum(1, maxNum);
              var sum = a - b;
            }
            return a + "-" + b + "=" + sum;
            break;
          }
        case "*":
          {
            var sum = a * b;
            return a + "x" + b + "=" + sum;
            break;
          }
        case "/":
          {
          	while(b == 0) {
          	    var b = getRandomNum(1, maxNum);
          	}
          	//如果分子不能整除分母，运行getFract函数把答案变成分数形式
            var sum = TrueFract(a,b);
            return a + "÷" + b + "=" + sum;
            break;
          }

        default:
          break;
      }
    }

    //分数的随机四则运算
    function countFract(a,b,c,d,maxNum){
       var arry = ["+", "-", "*", "/"];
       var n = getRandomNum(0, 3);
       //匹配运算符
      switch (arry[n]) {
        case "+":
          {
            var molecule = a * d + b * c;
            var denominator = c * d;
            var sum = TrueFract(molecule,denominator);
            return a + "/" + c + "+" + b + "/" + d + "=" + sum;
            break;
          }
        case "-":
          {
            var molecule = a * d - b * c;
            //如果是负数情况，重新随机生成数直到结果非负
            if (molecule < 0) {
              var a = getRandomNum(1, maxNum);
              var b = getRandomNum(1, maxNum);
              var c = getRandomNum(1, maxNum);
              var d = getRandomNum(1, maxNum);
              var molecule = a * d - b * c;
            }else if(molecule == 0) {
            	var sum = 0;
            }else {
            	var denominator = c * d;
                var sum = TrueFract(molecule,denominator);
            }
            return a + "/" + c + "-" + b + "/" + d + "=" + sum;
            break;
          }
        case "*":
          {
            var molecule = a * b;
            var denominator = c * d;
            var sum = TrueFract(molecule,denominator);
            return a + "/" + c + "x" + b + "/" + d + "=" + sum;
            break;
          }
        case "/":
          {
            var molecule = a * d;
            var denominator = c * d;
            var sum = TrueFract(molecule,denominator);
            return a + "/" + c + "÷" + b + "/" + d + "=" + sum;
            break;
          }

        default:
        break;
      }

    }


    //运行countInt函数
    function playCountInt(maxNum) {
      var a = getRandomNum(1, maxNum);
      var b = getRandomNum(1, maxNum);
      var c = getRandomNum(1, maxNum);
      var d = getRandomNum(1, maxNum);
      var IsInt = getRandomNum(0,1);
      var operator_num = getRandomNum(1,3);
      if(IsInt == "1") {
      	    var sum = countInt(a, b, maxNum);
      }else {
            var sum = countFract(a, b, c, d, maxNum);
      }
      return sum;
    }

    function playAll() {
      //将页面清空
      document.getElementById("text").innerHTML = "";
      //题目数目
      var qustionNum = document.getElementById("qustionNum").value;
      //运算范围，最大运算数字
      var maxNum = document.getElementById("maxNum").value;
      for (i = 1; i <= qustionNum; i++) {

        document.getElementById("text").innerHTML += ("<br>" + "第" + i + "题：");

        var answer = playCountInt(maxNum);
        document.getElementById("text").innerHTML += (answer);

      }
    }
  </script>
</body>

</html>